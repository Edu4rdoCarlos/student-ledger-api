model Document {
  id                     String         @id @default(uuid())
  version                Int            @default(1)

  // Ata (Minutes) document
  minutesHash            String?        @db.VarChar(64) // SHA-256 hash of minutes file
  minutesCid             String?        @db.VarChar(64) // IPFS CID of minutes file

  // Avaliação de Desempenho (Evaluation) document
  evaluationHash         String?        @db.VarChar(64) // SHA-256 hash of evaluation file
  evaluationCid          String?        @db.VarChar(64) // IPFS CID of evaluation file

  status                 DocumentStatus @default(PENDING)
  changeReason           String?        // Reason for new version
  inactivationReason     String?
  inactivatedAt          DateTime?
  blockchainTxId         String?
  blockchainRegisteredAt DateTime?
  createdAt              DateTime       @default(now())
  updatedAt              DateTime       @updatedAt

  defenseId         String
  defense           Defense    @relation(fields: [defenseId], references: [id])
  previousVersionId String?    @unique
  previousVersion   Document?  @relation("DocumentVersions", fields: [previousVersionId], references: [id])
  nextVersion       Document?  @relation("DocumentVersions")
  approvals         Approval[]

  @@unique([defenseId, version])
  @@index([defenseId])
  @@index([minutesHash])
  @@index([evaluationHash])
  @@index([status])
}

enum DocumentStatus {
  PENDING
  APPROVED
  INACTIVE
}
